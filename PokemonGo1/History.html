<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Transaction History - Pokemon Go Store</title>
    <link rel="stylesheet" href="styles.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap"
      rel="stylesheet"
    />
    <style>
      .history-container {
        max-width: 1200px;
        margin: 2rem auto;
        padding: 0 2rem;
      }

      .history-table {
        width: 100%;
        background: var(--card-background);
        border-radius: 15px;
        border-collapse: separate;
        border-spacing: 0;
        overflow: hidden;
        box-shadow: 0 4px 12px var(--shadow-color);
      }

      .history-table th,
      .history-table td {
        padding: 1.2rem;
        text-align: left;
        border-bottom: 1px solid var(--border-color);
        color: var(--text-color);
      }

      .history-table th {
        background: var(--background-color);
        font-weight: 600;
        font-size: 1.1rem;
      }

      .history-table tr:last-child td {
        border-bottom: none;
      }

      .history-table tbody tr {
        transition: background-color 0.3s ease;
      }

      .history-table tbody tr:hover {
        background: var(--background-color);
      }

      .status-completed {
        color: #4caf50;
        font-weight: 600;
      }

      .status-pending {
        color: #ff9800;
        font-weight: 600;
      }

      .status-failed {
        color: #f44336;
        font-weight: 600;
      }

      .transaction-id {
        font-family: monospace;
        font-size: 0.9rem;
        color: var(--accent-color);
      }

      .item-preview {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .item-preview img {
        width: 40px;
        height: 40px;
        object-fit: contain;
        border-radius: 8px;
      }
    </style>
  </head>
  <body>
    <div class="promo-banner">
      15% discount for your first Web Store purchase on any item $9.99 or more!
    </div>
    <header class="header">
      <nav class="nav">
        <div class="nav-left">
          <img
            src="assets/PokepalsLogo.png"
            alt="PokePals Logo"
            class="pokemon-logo"
          />
          <span class="store-text">Transaction History</span>
        </div>
        <div class="nav-right">
          <a href="index.html" class="nav-link">Home</a>
          <a href="store.html" class="nav-link">Store</a>
          <button class="theme-toggle" aria-label="Toggle dark mode">
            <svg
              class="sun-icon"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              width="14"
              height="14"
            >
              <circle cx="12" cy="12" r="5" fill="#FFB800" />
              <path
                fill="#FFB800"
                d="M12 3v2m0 14v2M3 12h2m14 0h2m-4.8-7.2l1.4 1.4M5.6 18.4l1.4 1.4m11.4-1.4l-1.4 1.4M7 5.6l-1.4 1.4"
              />
            </svg>
            <svg
              class="moon-icon"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              width="14"
              height="14"
            >
              <path
                fill="#5468FF"
                d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-3.03 0-5.5-2.47-5.5-5.5 0-1.82.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"
              />
            </svg>
          </button>
          <div
            class="profile-section"
            style="
              display: none;
              background: var(--profile-section-bg);
              padding: 0.5rem 1rem;
              border-radius: 24px;
              margin-left: 1rem;
            "
          >
            <a
              href="profile.html"
              class="profile-info"
              style="
                display: flex;
                align-items: center;
                gap: 0.5rem;
                text-decoration: none;
              "
            >
              <img
                src="assets/ultraball.png"
                alt="Profile Picture"
                class="profile-pic"
                style="
                  width: 32px;
                  height: 32px;
                  border-radius: 50%;
                  border: 2px solid var(--accent-color);
                "
              />
              <span
                class="profile-name"
                style="color: var(--text-color); font-weight: 500"
              ></span>
            </a>
            <button
              class="sign-out-btn"
              onclick="handleSignOut()"
              style="
                background: none;
                border: none;
                color: #ff4444;
                font-weight: 500;
                cursor: pointer;
                padding: 0.25rem 0.5rem;
                border-radius: 4px;
                margin-left: 1rem;
              "
            >
              Sign Out
            </button>
          </div>
          <button
            class="sign-in-btn"
            onclick="window.location.href='signin.html'"
            style="display: none"
          >
            Sign In
          </button>
        </div>
      </nav>
    </header>

    <main class="history-container">
      <h1 style="color: var(--text-color); margin-bottom: 2rem">
        Transaction History
      </h1>
      <table class="history-table">
        <thead>
          <tr>
            <th>Date</th>
            <th>Transaction ID</th>
            <th>Items</th>
            <th>Total</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>2024-03-15</td>
            <td><span class="transaction-id">TXN-24315-8F9A2</span></td>
            <td>
              <div class="item-preview">
                <img src="assets/GlobalTicket.png" alt="Global Ticket" />
                <span>Pokémon GO Fest 2025: Global Ticket</span>
              </div>
            </td>
            <td>₱439.00</td>
            <td><span class="status-completed">Completed</span></td>
          </tr>
          <tr>
            <td>2024-03-14</td>
            <td><span class="transaction-id">TXN-24314-7B3C1</span></td>
            <td>
              <div class="item-preview">
                <img src="assets/1300Coins.png" alt="1,300 PokéCoins" />
                <span>1,300 PokéCoins</span>
              </div>
            </td>
            <td>₱289.00</td>
            <td><span class="status-completed">Completed</span></td>
          </tr>
          <tr>
            <td>2024-03-12</td>
            <td><span class="transaction-id">TXN-24312-5D2E8</span></td>
            <td>
              <div class="item-preview">
                <img src="assets/UltraRaidBox.png" alt="Ultra Raid Box" />
                <span>Ultra Raid Box</span>
              </div>
            </td>
            <td>₱149.00</td>
            <td><span class="status-pending">Pending</span></td>
          </tr>
          <tr>
            <td>2024-03-10</td>
            <td><span class="transaction-id">TXN-24310-3A1F4</span></td>
            <td>
              <div class="item-preview">
                <img src="assets/MaxMushroom.png" alt="Max Mushroom" />
                <span>Max Mushroom</span>
              </div>
            </td>
            <td>₱289.00</td>
            <td><span class="status-failed">Failed</span></td>
          </tr>
          <tr>
            <td>2024-03-08</td>
            <td><span class="transaction-id">TXN-24308-2C9B7</span></td>
            <td>
              <div class="item-preview">
                <img src="assets/EggIncubator.png" alt="Egg Incubator" />
                <span>Egg Incubator</span>
              </div>
            </td>
            <td>₱88.00</td>
            <td><span class="status-completed">Completed</span></td>
          </tr>
        </tbody>
      </table>
    </main>

    <script>
      // Check authentication status
      window.addEventListener("DOMContentLoaded", () => {
        const userData = JSON.parse(localStorage.getItem("userData"));
        if (!userData) {
          window.location.href = "signin.html";
          return;
        }

        const profileSection = document.querySelector(".profile-section");
        const signInBtn = document.querySelector(".sign-in-btn");
        const profileName = document.querySelector(".profile-name");

        profileSection.style.display = "flex";
        signInBtn.style.display = "none";
        profileName.textContent = userData.ign;
      });

      function handleSignOut() {
        localStorage.removeItem("userData");
        window.location.href = "signin.html";
      }

      // Theme toggle functionality
      const themeToggle = document.querySelector(".theme-toggle");
      const prefersDarkScheme = window.matchMedia(
        "(prefers-color-scheme: dark)"
      );

      const getCurrentTheme = () => {
        const savedTheme = localStorage.getItem("theme");
        if (savedTheme) return savedTheme;
        return prefersDarkScheme.matches ? "dark" : "light";
      };

      const setTheme = (theme) => {
        document.documentElement.setAttribute("data-theme", theme);
        localStorage.setItem("theme", theme);
      };

      setTheme(getCurrentTheme());

      themeToggle.addEventListener("click", () => {
        const currentTheme = getCurrentTheme();
        const newTheme = currentTheme === "light" ? "dark" : "light";
        setTheme(newTheme);
      });

      prefersDarkScheme.addEventListener("change", (e) => {
        if (!localStorage.getItem("theme")) {
          setTheme(e.matches ? "dark" : "light");
        }
      });
    </script>
  </body>
</html>
